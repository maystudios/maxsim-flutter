{
  "branchName": "main",
  "projectName": "maxsim-flutter",
  "userStories": [
    {
      "id": "P1-001",
      "phase": 1,
      "priority": 1,
      "title": "Implement TypeScript project foundation and CLI entry point",
      "description": "Set up the TypeScript project with Commander.js CLI framework. Create src/cli/index.ts as the bin entry point that registers the 'create', 'add', and 'migrate' commands (initially as stubs). Ensure 'npx maxsim-flutter --version' and 'npx maxsim-flutter --help' work correctly. Wire up the bin field in package.json to dist/cli/index.js with proper shebang.",
      "acceptanceCriteria": [
        "src/cli/index.ts exists with Commander.js program setup and shebang",
        "src/cli/commands/create.ts, add.ts, migrate.ts exist as stub commands",
        "'npm run build' compiles without errors",
        "'node dist/cli/index.js --version' prints '0.1.0'",
        "'node dist/cli/index.js --help' shows create, add, migrate commands"
      ],
      "passes": true
    },
    {
      "id": "P1-002",
      "phase": 1,
      "priority": 2,
      "title": "Implement Zod config schema and config loader",
      "description": "Create the central Zod schema in src/core/config/schema.ts that validates maxsim.config.yaml. Include all sections: project, platforms, modules (auth, api, database, i18n, theme, push, analytics, cicd, deep-linking), claude, scaffold. Create src/core/config/loader.ts to read and parse YAML config files. Create src/core/config/defaults.ts with sensible default values. Write unit tests for schema validation.",
      "acceptanceCriteria": [
        "src/core/config/schema.ts exports MaxsimConfigSchema with Zod",
        "src/core/config/loader.ts can read and validate a YAML file",
        "src/core/config/defaults.ts exports default config values",
        "src/types/config.ts exports MaxsimConfig type inferred from Zod",
        "tests/unit/schema.test.ts passes with valid and invalid config cases",
        "npm run typecheck passes"
      ],
      "passes": true
    },
    {
      "id": "P1-003",
      "phase": 1,
      "priority": 3,
      "title": "Implement ProjectContext type and validator",
      "description": "Create src/core/context.ts with the ProjectContext interface that carries all resolved project settings through the pipeline. Create src/core/validator.ts that checks pre-flight requirements (Flutter SDK installed, Dart installed, git installed, target directory writable). Create src/types/project.ts with GeneratedFile and other shared types.",
      "acceptanceCriteria": [
        "src/core/context.ts exports ProjectContext interface",
        "src/core/validator.ts exports validateEnvironment() that checks flutter, dart, git",
        "src/types/project.ts exports GeneratedFile, TemplateInstruction types",
        "Validator returns clear error messages when tools are missing",
        "npm run typecheck passes"
      ],
      "passes": true
    },
    {
      "id": "P1-004",
      "phase": 1,
      "priority": 4,
      "title": "Implement Handlebars template renderer",
      "description": "Create src/scaffold/renderer.ts with a Handlebars-based template renderer. Register custom helpers: ifEquals, ifIncludes, camelCase, pascalCase, snakeCase. The renderer takes a template file path and a TemplateContext, returns rendered string. Support partials for reusable template fragments. Write unit tests.",
      "acceptanceCriteria": [
        "src/scaffold/renderer.ts exports TemplateRenderer class",
        "Supports .hbs file rendering with TemplateContext",
        "Custom helpers (ifEquals, ifIncludes, camelCase, pascalCase, snakeCase) work",
        "Partial templates can be registered and used",
        "tests/unit/renderer.test.ts passes",
        "npm run typecheck passes"
      ],
      "passes": true
    },
    {
      "id": "P1-005",
      "phase": 1,
      "priority": 5,
      "title": "Implement file writer with dry-run and conflict detection",
      "description": "Create src/scaffold/file-writer.ts that writes rendered files to the output directory. Support dry-run mode (prints what would be written without writing). Detect file conflicts when target files already exist. Support overwrite modes: ask, always, never. Write unit tests using a temp directory.",
      "acceptanceCriteria": [
        "src/scaffold/file-writer.ts exports FileWriter class",
        "writeAll() writes Map<path, content> to disk",
        "dry-run mode logs files without writing",
        "Conflict detection works when files exist",
        "Overwrite modes (ask/always/never) are respected",
        "tests/unit/file-writer.test.ts passes",
        "npm run typecheck passes"
      ],
      "passes": true
    },
    {
      "id": "P1-006",
      "phase": 1,
      "priority": 6,
      "title": "Implement scaffold engine orchestrator",
      "description": "Create src/scaffold/engine.ts as the main orchestrator. It receives a ProjectContext and coordinates: module resolution -> template composition -> rendering -> file writing -> post-processing. Create post-processors in src/scaffold/post-processors/ for dart-format, flutter-pub-get, and build-runner (using execa to run shell commands).",
      "acceptanceCriteria": [
        "src/scaffold/engine.ts exports ScaffoldEngine class with run(context) method",
        "Engine chains: resolve modules -> compose templates -> render -> write -> post-process",
        "src/scaffold/post-processors/dart-format.ts runs 'dart format .'",
        "src/scaffold/post-processors/flutter-pub-get.ts runs 'flutter pub get'",
        "src/scaffold/post-processors/build-runner.ts runs 'dart run build_runner build'",
        "Post-processors can be skipped via config flags",
        "npm run typecheck passes"
      ],
      "passes": true
    },
    {
      "id": "P1-007",
      "phase": 1,
      "priority": 7,
      "title": "Create core Flutter templates (Clean Architecture + Riverpod + go_router)",
      "description": "Create all Handlebars templates in templates/core/ for the base Flutter project. This includes: pubspec.yaml.hbs, analysis_options.yaml.hbs, lib/main.dart.hbs (ProviderScope + GoRouter setup), lib/app.dart.hbs, lib/core/router/app_router.dart.hbs, lib/core/theme/app_theme.dart.hbs, lib/core/providers/app_providers.dart.hbs, lib/features/home/ example feature with data/domain/presentation layers, test/widget_test.dart.hbs.",
      "acceptanceCriteria": [
        "templates/core/pubspec.yaml.hbs generates valid pubspec with riverpod, go_router, build_runner",
        "templates/core/analysis_options.yaml.hbs includes recommended Flutter lints",
        "templates/core/lib/main.dart.hbs has ProviderScope and MaterialApp.router",
        "templates/core/lib/core/router/app_router.dart.hbs has TypedGoRoute setup",
        "templates/core/lib/features/home/ has Clean Architecture layers",
        "templates/core/test/widget_test.dart.hbs is a valid test",
        "All templates use TemplateContext variables correctly"
      ],
      "passes": true
    },
    {
      "id": "P1-008",
      "phase": 1,
      "priority": 8,
      "title": "Implement interactive create command with @clack/prompts",
      "description": "Wire up src/cli/commands/create.ts to be fully functional. Use @clack/prompts for interactive input: project name, org ID, description, platform selection (checkboxes). Build a ProjectContext from user input + defaults. Call ScaffoldEngine.run(). Show spinner during generation, success message after. Support --yes flag for non-interactive mode.",
      "acceptanceCriteria": [
        "src/cli/commands/create.ts prompts for name, org, description, platforms",
        "src/cli/ui/prompts.ts wraps @clack/prompts for project creation questions",
        "Builds ProjectContext from interactive answers",
        "Calls ScaffoldEngine.run(context) to generate the project",
        "Shows ora spinner during generation",
        "--yes flag skips all prompts and uses defaults",
        "Writes maxsim.config.yaml to generated project"
      ],
      "passes": true
    },
    {
      "id": "P1-009",
      "phase": 1,
      "priority": 9,
      "title": "Integration test: create command generates working Flutter project",
      "description": "Write an integration test that runs the create command into a temp directory and validates the output. Check that the Flutter project structure is correct, pubspec.yaml is valid YAML, Clean Architecture directories exist, and key files contain expected content.",
      "acceptanceCriteria": [
        "tests/integration/create-command.test.ts exists and passes",
        "Test creates a project in a temp directory",
        "Validates directory structure matches Clean Architecture",
        "Validates pubspec.yaml is valid and contains required deps",
        "Validates main.dart contains ProviderScope",
        "Validates app_router.dart contains GoRouter setup",
        "npm test passes all tests"
      ],
      "passes": true
    },
    {
      "id": "P2-001",
      "phase": 2,
      "priority": 10,
      "title": "Implement ModuleManifest interface and module registry",
      "description": "Create src/types/module.ts with ModuleManifest, ModuleContribution, ModuleQuestion interfaces. Create src/modules/registry.ts that discovers and loads all module definitions from src/modules/definitions/. Create src/modules/definitions/core/module.ts as the always-included base module.",
      "acceptanceCriteria": [
        "src/types/module.ts exports ModuleManifest with all fields",
        "src/modules/registry.ts exports ModuleRegistry that loads all module definitions",
        "src/modules/definitions/core/module.ts exports a valid ModuleManifest",
        "Registry correctly discovers all module definitions",
        "npm run typecheck passes"
      ],
      "passes": true
    },
    {
      "id": "P2-002",
      "phase": 2,
      "priority": 11,
      "title": "Implement module dependency resolver with topological sort",
      "description": "Create src/modules/resolver.ts that performs topological sort on selected modules based on their 'requires' dependencies. Detect and reject circular dependencies. Validate that no conflicting modules are selected together. Write unit tests.",
      "acceptanceCriteria": [
        "src/modules/resolver.ts exports ModuleResolver with resolve(selectedIds) method",
        "Topological sort orders modules by dependency",
        "Circular dependency detection throws clear error",
        "Conflict detection prevents incompatible modules",
        "tests/unit/resolver.test.ts covers: valid order, missing dep, circular, conflict",
        "npm run typecheck passes"
      ],
      "passes": true
    },
    {
      "id": "P2-003",
      "phase": 2,
      "priority": 12,
      "title": "Implement module composer with pubspec merging",
      "description": "Create src/modules/composer.ts that takes resolved ModuleManifests and a ProjectContext, then merges all template contributions into a unified file map. Pubspec.partial.yaml merging and provider contributions to app_providers.dart. Write unit tests.",
      "acceptanceCriteria": [
        "src/modules/composer.ts exports ModuleComposer with compose() method",
        "Merges pubspec.partial.yaml fragments from all active modules",
        "Deduplicates dependencies (newer version wins)",
        "Merges provider contributions into app_providers.dart barrel file",
        "tests/unit/composer.test.ts passes",
        "npm run typecheck passes"
      ],
      "passes": true
    },
    {
      "id": "P2-004",
      "phase": 2,
      "priority": 13,
      "title": "Implement auth module definition and templates",
      "description": "Create src/modules/definitions/auth/module.ts with full ModuleManifest for authentication. Support providers: firebase, supabase, custom. Create templates/modules/auth/ with Clean Architecture layers. Include pubspec.partial.yaml.",
      "acceptanceCriteria": [
        "src/modules/definitions/auth/module.ts exports valid ModuleManifest",
        "templates/modules/auth/lib/features/auth/ has domain, data, presentation layers",
        "templates/modules/auth/pubspec.partial.yaml has correct deps per provider",
        "Templates use conditional rendering for provider-specific code"
      ],
      "passes": true
    },
    {
      "id": "P2-005",
      "phase": 2,
      "priority": 14,
      "title": "Implement API module definition and templates",
      "description": "Create src/modules/definitions/api/module.ts for HTTP client setup with Dio, interceptors, error handling. Create templates/modules/api/ with Dio client setup.",
      "acceptanceCriteria": [
        "src/modules/definitions/api/module.ts exports valid ModuleManifest",
        "templates/modules/api/ has Dio client setup with interceptors",
        "Error handling with typed ApiException",
        "pubspec.partial.yaml includes dio, retrofit, json_annotation"
      ],
      "passes": true
    },
    {
      "id": "P2-006",
      "phase": 2,
      "priority": 15,
      "title": "Implement theme module definition and templates",
      "description": "Create src/modules/definitions/theme/module.ts for advanced theming with Material 3 seed color, dark/light switching via Riverpod.",
      "acceptanceCriteria": [
        "src/modules/definitions/theme/module.ts exports valid ModuleManifest",
        "templates/modules/theme/ has ThemeData setup with ColorScheme.fromSeed",
        "Theme provider supports light/dark mode switching via Riverpod",
        "pubspec.partial.yaml has theme-related deps"
      ],
      "passes": true
    },
    {
      "id": "P2-007",
      "phase": 2,
      "priority": 16,
      "title": "Wire module selection into create command and integration test",
      "description": "Update create command with interactive module selection, per-module config questions, --modules flag. Wire ModuleResolver and ModuleComposer into ScaffoldEngine. Update integration test.",
      "acceptanceCriteria": [
        "Create command shows module selection checkboxes",
        "--modules auth,api,theme flag works for non-interactive mode",
        "ScaffoldEngine uses ModuleResolver and ModuleComposer",
        "Generated project includes selected module files",
        "pubspec.yaml contains merged dependencies",
        "npm test passes all tests"
      ],
      "passes": true
    },
    {
      "id": "P2-008",
      "phase": 2,
      "priority": 17,
      "title": "Implement database module definition and templates",
      "description": "Create database module supporting drift, hive, and isar with templates for each engine.",
      "acceptanceCriteria": [
        "src/modules/definitions/database/module.ts exports valid ModuleManifest",
        "Templates conditionally render based on engine choice",
        "pubspec.partial.yaml includes correct deps per engine"
      ],
      "passes": true
    },
    {
      "id": "P2-009",
      "phase": 2,
      "priority": 18,
      "title": "Implement i18n module definition and templates",
      "description": "Create i18n module with ARB files, l10n.yaml config, localization delegates in MaterialApp.",
      "acceptanceCriteria": [
        "src/modules/definitions/i18n/module.ts exports valid ModuleManifest",
        "Templates include ARB files for selected locales",
        "MaterialApp.router uses localizationsDelegates",
        "pubspec.partial.yaml includes flutter_localizations, intl"
      ],
      "passes": true
    },
    {
      "id": "P2-010",
      "phase": 2,
      "priority": 19,
      "title": "Implement push, analytics, cicd, deep-linking modules",
      "description": "Create remaining four module definitions and their templates: push notifications (firebase/onesignal), analytics (service abstraction + go_router observer), CI/CD (github/gitlab/bitbucket pipelines), deep linking (app links + go_router integration).",
      "acceptanceCriteria": [
        "src/modules/definitions/push/module.ts with firebase/onesignal support",
        "src/modules/definitions/analytics/module.ts with AnalyticsService abstraction",
        "src/modules/definitions/cicd/module.ts with GitHub Actions/GitLab CI templates",
        "src/modules/definitions/deep-linking/module.ts with go_router integration",
        "All four modules have valid templates and pubspec partials"
      ],
      "passes": true
    },
    {
      "id": "P3-001",
      "phase": 3,
      "priority": 20,
      "title": "Implement CLAUDE.md generator for Flutter projects",
      "description": "Create src/claude-setup/claude-md-generator.ts that generates a comprehensive CLAUDE.md optimized for Claude Code Agent Teams. Include: architecture rules, Riverpod patterns, go_router conventions, Agent Teams workflow instructions (how to create a team, what roles to spawn, how to use prd.json as task source), module-specific sections, quality gates.",
      "acceptanceCriteria": [
        "src/claude-setup/claude-md-generator.ts exports generateClaudeMd(context)",
        "Generated CLAUDE.md includes Agent Teams workflow section",
        "Architecture section covers Clean Arch layer rules",
        "Riverpod and go_router sections with patterns",
        "Module-specific sections conditionally included",
        "Quality gates section (flutter analyze, flutter test)"
      ],
      "passes": true
    },
    {
      "id": "P3-002",
      "phase": 3,
      "priority": 21,
      "title": "Implement agent definitions writer for Flutter projects",
      "description": "Create src/claude-setup/agent-writer.ts that generates .claude/agents/ optimized for Agent Teams. Agents are designed as teammate roles: architect reviews architecture before builders implement, tester validates after builders finish, reviewer checks Clean Arch compliance, docs writes documentation. Each agent has clear scope and communication patterns.",
      "acceptanceCriteria": [
        "src/claude-setup/agent-writer.ts exports writeAgents(context, outputPath)",
        "5 agent templates designed as Agent Teams teammates",
        "flutter-architect: Sonnet, read-only tools, reviews before implementation",
        "flutter-feature-builder: Sonnet, all tools, claims tasks and implements",
        "flutter-tester: Sonnet, all tools, messages builders about failures",
        "flutter-reviewer: Sonnet, read-only tools, reviews after implementation",
        "flutter-docs: Haiku, edit tools, documents after review"
      ],
      "passes": true
    },
    {
      "id": "P3-003",
      "phase": 3,
      "priority": 22,
      "title": "Implement skills, hooks, and MCP config writer",
      "description": "Create skill writer (flutter-patterns, go-router-patterns, module-conventions, prd skills). Create hooks writer with TaskCompleted hook that enforces flutter analyze + flutter test. Create MCP config writer. Create commands (add-feature, analyze).",
      "acceptanceCriteria": [
        "4 skill templates generated in .claude/skills/",
        "TaskCompleted hook runs flutter analyze + flutter test",
        "TeammateIdle hook optionally checks for uncommitted work",
        ".mcp.json includes relevant MCP servers based on modules",
        "Commands: add-feature.md, analyze.md"
      ],
      "passes": true
    },
    {
      "id": "P3-004",
      "phase": 3,
      "priority": 23,
      "title": "Wire Claude setup into scaffold engine and generate PRD",
      "description": "Update ScaffoldEngine to call all claude-setup generators. Generate .claude/ directory with CLAUDE.md, agents, skills, commands, hooks, MCP config. Implement PRD generator that creates prd.json for the generated Flutter project (so Agent Teams can use it as task source). Respect --no-claude flag.",
      "acceptanceCriteria": [
        "ScaffoldEngine generates complete .claude/ directory",
        "--no-claude flag skips Claude setup",
        "PRD generator creates prd.json with phased stories from selected modules",
        "All agents, skills, commands, hooks present in generated project",
        "Integration test verifies .claude/ output"
      ],
      "passes": true
    },
    {
      "id": "P3-005",
      "phase": 3,
      "priority": 24,
      "title": "Implement add command for adding modules to existing projects",
      "description": "Implement src/cli/commands/add.ts fully. Detect existing project, validate module, generate files, merge pubspec, update config, update Claude setup.",
      "acceptanceCriteria": [
        "src/cli/commands/add.ts fully functional",
        "Detects maxsim.config.yaml in project",
        "Generates only new module files",
        "Merges new dependencies into existing pubspec.yaml",
        "Updates maxsim.config.yaml and .claude/ setup",
        "--dry-run shows what would change"
      ],
      "passes": true
    },
    {
      "id": "P3-006",
      "phase": 3,
      "priority": 25,
      "title": "Implement migrate command with analysis",
      "description": "Implement migrate command with project detector. Analyze existing Flutter project structure, detect patterns, report gaps, create maxsim.config.yaml, add .claude/ setup.",
      "acceptanceCriteria": [
        "src/cli/commands/migrate.ts fully functional",
        "src/core/detector.ts analyzes existing Flutter project",
        "--analysis-only outputs report without changes",
        "Full migrate creates maxsim.config.yaml and .claude/ directory",
        "Non-destructive: never deletes existing files"
      ],
      "passes": true
    },
    {
      "id": "P4-001",
      "phase": 4,
      "priority": 26,
      "title": "Create Claude Code plugin structure",
      "description": "Create claude-plugin/ with plugin.json, commands (flutter-create, flutter-add, flutter-migrate), skills (flutter-scaffolding), and agents (flutter-setup-agent).",
      "acceptanceCriteria": [
        "claude-plugin/.claude-plugin/plugin.json has valid metadata",
        "3 command files wrapping CLI commands",
        "flutter-scaffolding skill provides module context",
        "flutter-setup-agent guides users through setup"
      ],
      "passes": true
    },
    {
      "id": "P4-002",
      "phase": 4,
      "priority": 27,
      "title": "Write README and documentation",
      "description": "Write README.md covering: installation, quick start, all commands, module descriptions, Agent Teams workflow (how to use generated projects with Claude Code Agent Teams), Ralph fallback, config reference, contributing guide.",
      "acceptanceCriteria": [
        "README.md has installation and quick start",
        "All 3 commands documented with flags and examples",
        "Agent Teams workflow section with step-by-step guide",
        "Module table with descriptions",
        "Configuration reference"
      ],
      "passes": true
    },
    {
      "id": "P4-003",
      "phase": 4,
      "priority": 28,
      "title": "Full integration test suite and npm publish preparation",
      "description": "Comprehensive integration tests, CHANGELOG.md, verify npm pack, ensure all quality gates pass.",
      "acceptanceCriteria": [
        "Integration tests for create, add, migrate commands",
        "Test: create with all modules generates complete project with .claude/",
        "Test: add module merges correctly",
        "CHANGELOG.md with v0.1.0 entry",
        "'npm pack' produces correct tarball",
        "All tests pass, typecheck passes"
      ],
      "passes": true
    },
    {
      "id": "P5-001",
      "phase": 5,
      "priority": 29,
      "title": "GitHub Actions CI/CD for maxsim-flutter",
      "description": "Create .github/workflows/ci.yml that runs npm run typecheck, npm run lint, and npm test on every push and PR. Add a release.yml workflow triggered by v* tags that publishes to npm with provenance (--provenance flag).",
      "acceptanceCriteria": [
        ".github/workflows/ci.yml runs typecheck + lint + test on push/PR to main",
        ".github/workflows/release.yml triggers on v* tags, builds, tests, then npm publish --provenance",
        "Secrets documented: NPM_TOKEN required in repo settings",
        "Badge in README links to workflow status"
      ],
      "passes": true
    },
    {
      "id": "P5-002",
      "phase": 5,
      "priority": 30,
      "title": "Prepare package for first npm publish",
      "description": "Fix repository.url in package.json to real GitHub URL. Verify files[] array is complete. Add publishConfig with access: public. Run npm pack --dry-run and verify tarball contents. Confirm prepublishOnly runs build + test. Create LICENSE file if missing.",
      "acceptanceCriteria": [
        "npm pack --dry-run shows exactly: dist/, templates/, claude-plugin/, README.md, CHANGELOG.md, package.json, LICENSE",
        "package.json has real repository.url and publishConfig: { access: public }",
        "npm run prepublishOnly passes typecheck, lint, and tests",
        "No .env, secrets, or dev files included in pack"
      ],
      "passes": true
    },
    {
      "id": "P5-003",
      "phase": 5,
      "priority": 31,
      "title": "Implement list command to show project module status",
      "description": "Create src/cli/commands/list.ts. Detect maxsim.config.yaml, display table of all modules and their enabled/disabled status. Support --project-dir flag.",
      "acceptanceCriteria": [
        "maxsim-flutter list outputs a readable table of all modules with their status",
        "maxsim-flutter list --project-dir <path> works",
        "Throws helpful error if no maxsim.config.yaml found",
        "Unit tests added",
        "Command registered in CLI entry point"
      ],
      "passes": true
    },
    {
      "id": "P5-004",
      "phase": 5,
      "priority": 32,
      "title": "Extract shared template helpers to eliminate create/add duplication",
      "description": "Both create.ts and add.ts contain copies of buildTemplateContext and pubspec-merging logic. Extract to src/scaffold/template-helpers.ts and update both commands to import from shared location.",
      "acceptanceCriteria": [
        "src/scaffold/template-helpers.ts exports shared functions",
        "create.ts and add.ts both import from the shared module",
        "No duplicate function bodies remain",
        "All existing tests still pass",
        "npm run typecheck and npm run lint pass"
      ],
      "passes": true
    },
    {
      "id": "P5-005",
      "phase": 5,
      "priority": 33,
      "title": "Improve post-processor error handling and user feedback",
      "description": "engine.ts silently swallows all post-processor errors. Capture error messages and surface them to users. Add postProcessorErrors array to ScaffoldResult.",
      "acceptanceCriteria": [
        "ScaffoldResult includes postProcessorErrors: string[]",
        "When dart format fails, user sees: dart format skipped with reason",
        "When flutter pub get fails, user sees the actual error message",
        "Engine tests updated to verify error messages surface"
      ],
      "passes": true
    },
    {
      "id": "P5-006",
      "phase": 5,
      "priority": 34,
      "title": "Add version check and update nudge on CLI startup",
      "description": "On first run per day, check npm registry for latest version. If newer version exists, print a friendly nudge. Non-blocking (network failure silently ignored). Throttled by timestamp file.",
      "acceptanceCriteria": [
        "Version check runs at most once per day",
        "Network errors silently ignored",
        "Nudge appears at bottom of command output",
        "--no-update-check flag disables the check globally"
      ],
      "passes": true
    },
    {
      "id": "P5-NPM-001",
      "phase": 5,
      "priority": 35,
      "title": "Automated npm publish workflow with provenance attestation",
      "description": "Create .github/workflows/release.yml triggered by v* tags. Steps: checkout, Node 18, npm ci, npm run prepublishOnly, npm publish --provenance --access public. Configure NPM_TOKEN secret. Add npm badge to README.",
      "acceptanceCriteria": [
        "Tag v0.1.0 triggers release workflow",
        "Workflow passes typecheck + lint + test before publish",
        "Package published with provenance",
        "npm badge in README shows current version",
        "Documented: how to create a release (tag + push)"
      ],
      "passes": true
    },
    {
      "id": "P5-NPM-002",
      "phase": 5,
      "priority": 36,
      "title": "Package validation and dry-run gate",
      "description": "Add validate:pack npm script that runs npm pack --dry-run and asserts correct files included, no secrets, size < 2MB. Integrate into CI.",
      "acceptanceCriteria": [
        "npm run validate:pack script exists",
        "Script fails if node_modules/ or .env appear in pack output",
        "CI runs validate:pack step before npm publish",
        "Total pack size < 2MB enforced"
      ],
      "passes": true
    },
    {
      "id": "P5-NPM-003",
      "phase": 5,
      "priority": 37,
      "title": "CHANGELOG and release notes automation",
      "description": "Install conventional-changelog-cli. Add changelog npm script. Document commit convention. Verify existing CHANGELOG.md with v0.1.0 entry.",
      "acceptanceCriteria": [
        "CHANGELOG.md exists with v0.1.0 entry",
        "npm run changelog updates CHANGELOG.md from commit history",
        "Commit format generates correct changelog entries",
        "CHANGELOG linked from README"
      ],
      "passes": true
    },
    {
      "id": "P6-001",
      "phase": 6,
      "priority": 38,
      "title": "Expand template coverage for push, analytics, and deep-linking modules",
      "description": "Audit templates against auth/api benchmark. Push missing use cases, analytics missing route observer wiring, deep-linking missing route handler integration.",
      "acceptanceCriteria": [
        "Push module has domain/usecases/ with RequestPermissionUseCase, HandleNotificationUseCase",
        "Analytics module analytics_route_observer.dart is wired into app_router",
        "Deep-linking module provider is wired into GoRouter redirect guard",
        "Integration tests verify new files are generated"
      ],
      "passes": true
    },
    {
      "id": "P6-002",
      "phase": 6,
      "priority": 39,
      "title": "Generate README.md in scaffolded projects",
      "description": "Add templates/core/README.md.hbs that documents project structure, enabled modules, run instructions, Agent Teams section.",
      "acceptanceCriteria": [
        "README.md is generated in every new project",
        "README contains project name, enabled modules list, run instructions",
        "README has Agent Teams section if claude.agentTeams is true",
        "Integration test verifies README generated with correct project name"
      ],
      "passes": true
    },
    {
      "id": "P6-003",
      "phase": 6,
      "priority": 40,
      "title": "Make module ID lists registry-driven",
      "description": "engine.ts getEnabledModuleIds and add.ts ADDABLE_MODULE_IDS are hardcoded. Refactor so ModuleRegistry is single source of truth.",
      "acceptanceCriteria": [
        "ModuleRegistry.getAllOptionalIds() returns all registered non-core module IDs",
        "engine.ts getEnabledModuleIds uses the registry",
        "add.ts ADDABLE_MODULE_IDS replaced by registry query",
        "Adding a new module requires ONLY module.ts + templates",
        "All existing tests still pass"
      ],
      "passes": true
    },
    {
      "id": "P6-004",
      "phase": 6,
      "priority": 41,
      "title": "Add snapshot tests for generated Dart file content",
      "description": "Add Jest snapshot tests for key rendered files (main.dart, app_router.dart, login_page.dart) across module combinations.",
      "acceptanceCriteria": [
        "tests/unit/snapshots/ directory with .snap files",
        "toMatchSnapshot() used for main.dart, pubspec.yaml, app_router.dart",
        "Snapshot update workflow documented",
        "CI fails if snapshots drift without being updated"
      ],
      "passes": true
    },
    {
      "id": "P6-005",
      "phase": 6,
      "priority": 42,
      "title": "Improve migrate detector with lib/ directory structure analysis",
      "description": "Enhance ProjectDetector to scan lib/ for feature structure, identify layer violations, produce more precise gap analysis.",
      "acceptanceCriteria": [
        "analyzeProject() scans lib/ for features/ subdirectories",
        "Detects existing feature names and reports them",
        "Identifies direct presentation-to-data imports as a gap",
        "AnalysisReport.detectedFeatures field contains discovered feature names",
        "Updated unit tests for enhanced detector"
      ],
      "passes": true
    },
    {
      "id": "P6-006",
      "phase": 6,
      "priority": 43,
      "title": "Add per-module configuration prompts in interactive create flow",
      "description": "After module multi-select in create, show follow-up prompts for auth provider, database engine, API base URL, locales etc. --yes skips with defaults.",
      "acceptanceCriteria": [
        "After module selection, follow-up prompts appear for modules with questions",
        "--yes flag skips follow-up prompts and uses defaults",
        "Unit test for prompt flow using mock answers",
        "No regression on existing --yes non-interactive path"
      ],
      "passes": true
    },
    {
      "id": "P7-001",
      "phase": 7,
      "priority": 44,
      "title": "Support external/community module packages",
      "description": "Allow users to register third-party module packages via maxsim.config.yaml externalModules array. CLI resolves and loads from node_modules at runtime.",
      "acceptanceCriteria": [
        "maxsim.config.yaml supports externalModules: string[]",
        "ModuleRegistry.loadExternal(packageName) loads from node_modules",
        "Sample module package structure documented",
        "Error thrown if external module has invalid manifest",
        "Unit tests for external module loading"
      ],
      "passes": true
    },
    {
      "id": "P7-002",
      "phase": 7,
      "priority": 45,
      "title": "Implement upgrade command to refresh .claude/ directory",
      "description": "maxsim-flutter upgrade re-runs runClaudeSetup with current config and latest templates. Backs up user-edited agent files before overwrite.",
      "acceptanceCriteria": [
        "maxsim-flutter upgrade re-generates CLAUDE.md and .claude/ contents",
        "Existing user-edited agent files backed up with .bak extension",
        "--dry-run shows what would change",
        "Success message lists updated files"
      ],
      "passes": true
    },
    {
      "id": "P7-003",
      "phase": 7,
      "priority": 46,
      "title": "Add CI step that validates generated Dart code compiles",
      "description": "Add flutter-validate.yml workflow using Flutter Docker image. Creates test project, runs flutter pub get, flutter analyze.",
      "acceptanceCriteria": [
        ".github/workflows/flutter-validate.yml exists",
        "Uses subosito/flutter-action@v2 to install Flutter",
        "Tests core + auth + api + theme combinations",
        "Fails CI if flutter analyze reports errors",
        "Annotated as separate workflow not blocking main CI"
      ],
      "passes": true
    },
    {
      "id": "P7-004",
      "phase": 7,
      "priority": 47,
      "title": "Write contributor guide and architecture documentation",
      "description": "Create CONTRIBUTING.md with dev setup, how to add a module, template conventions, test instructions, PR process. Create docs/architecture.md.",
      "acceptanceCriteria": [
        "CONTRIBUTING.md at project root with complete dev setup instructions",
        "How to add a new module walkthrough",
        "docs/architecture.md describes subsystem relationships with diagram",
        "README has Contributing section linking to CONTRIBUTING.md"
      ],
      "passes": false
    },
    {
      "id": "P7-005",
      "phase": 7,
      "priority": 48,
      "title": "Interactive create wizard â€” project template presets",
      "description": "Before asking individual questions, offer preset bundles: Minimal (core), Standard (auth+api+theme), Full Featured (all), Custom (pick manually).",
      "acceptanceCriteria": [
        "First prompt in interactive flow is preset selection",
        "Selecting Standard pre-fills auth/api/theme",
        "Selecting Full Featured pre-fills all 9 modules",
        "Custom falls through to existing module multi-select",
        "--yes skips preset and defaults to minimal"
      ],
      "passes": false
    }
  ]
}
